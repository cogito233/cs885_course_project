nohup: ignoring input
[09:11:55] ======================================================================
[09:11:55] ğŸ”¬ Stateful KV Cache ç‰ˆæœ¬ - Runtime ç»´æŠ¤ KV State
[09:11:55] ======================================================================
[09:11:55] ğŸš€ æ ¸å¿ƒä¼˜åŒ–: é¿å…æ¯è½® full prefillï¼ŒRuntime è‡ªåŠ¨å¤ç”¨ KV
[09:11:55]    â†’ èŠ‚çœ >99% çš„ prefill è®¡ç®—ï¼Œé¢„è®¡ååæå‡ 3-4x
[09:11:55] ğŸ“Š è¿½è¸ª: æ»‘åŠ¨çª—å£ååé‡ï¼ˆ10ç§’çª—å£ï¼Œå¸¦è¡°å‡ï¼‰
[09:11:55] ======================================================================
[09:11:55] ğŸ¤– æ¨¡å‹: Qwen2.5-14B (128kä¸Šä¸‹æ–‡)
[09:11:55] ğŸ¯ é…ç½®: GPU 3 | 50æ¡è½¨è¿¹ | 50è½®å¯¹è¯
[09:11:55] ğŸ”¢ æµ‹è¯•: Batch Size = [16, 12]
[09:11:55] ======================================================================
[09:11:55] 
[1/3] åŠ è½½...
[09:11:55] âœ“ 50æ¡è½¨è¿¹
[09:11:55] 
[2/3] åŠ è½½æ¨¡å‹...
[09:11:55] ä¼˜åŒ–é…ç½®: æé«˜æ˜¾å­˜åˆ©ç”¨ç‡
[09:11:55] ä½¿ç”¨ç«¯å£: 30030
/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
[2025-11-26 09:12:06] WARNING server_args.py:1213: Attention backend not explicitly specified. Use fa3 backend by default.
/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
Loading safetensors checkpoint shards:   0% Completed | 0/8 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  12% Completed | 1/8 [00:00<00:04,  1.49it/s]
Loading safetensors checkpoint shards:  25% Completed | 2/8 [00:01<00:04,  1.29it/s]
Loading safetensors checkpoint shards:  38% Completed | 3/8 [00:02<00:04,  1.23it/s]
Loading safetensors checkpoint shards:  50% Completed | 4/8 [00:03<00:03,  1.23it/s]
Loading safetensors checkpoint shards:  62% Completed | 5/8 [00:04<00:02,  1.23it/s]
Loading safetensors checkpoint shards:  75% Completed | 6/8 [00:04<00:01,  1.23it/s]
Loading safetensors checkpoint shards:  88% Completed | 7/8 [00:05<00:00,  1.25it/s]
Loading safetensors checkpoint shards: 100% Completed | 8/8 [00:05<00:00,  1.48it/s]
Loading safetensors checkpoint shards: 100% Completed | 8/8 [00:05<00:00,  1.33it/s]

  0%|          | 0/36 [00:00<?, ?it/s]Capturing batches (bs=256 avail_mem=85.85 GB):   0%|          | 0/36 [00:00<?, ?it/s]Capturing batches (bs=256 avail_mem=85.85 GB):   3%|â–         | 1/36 [00:00<00:09,  3.63it/s]Capturing batches (bs=248 avail_mem=85.70 GB):   3%|â–         | 1/36 [00:00<00:09,  3.63it/s]Capturing batches (bs=240 avail_mem=85.69 GB):   3%|â–         | 1/36 [00:00<00:09,  3.63it/s]Capturing batches (bs=240 avail_mem=85.69 GB):   8%|â–Š         | 3/36 [00:00<00:03,  8.44it/s]Capturing batches (bs=232 avail_mem=85.68 GB):   8%|â–Š         | 3/36 [00:00<00:03,  8.44it/s]Capturing batches (bs=224 avail_mem=85.68 GB):   8%|â–Š         | 3/36 [00:00<00:03,  8.44it/s]Capturing batches (bs=224 avail_mem=85.68 GB):  14%|â–ˆâ–        | 5/36 [00:00<00:02, 10.57it/s]Capturing batches (bs=216 avail_mem=85.67 GB):  14%|â–ˆâ–        | 5/36 [00:00<00:02, 10.57it/s]Capturing batches (bs=208 avail_mem=85.66 GB):  14%|â–ˆâ–        | 5/36 [00:00<00:02, 10.57it/s]Capturing batches (bs=208 avail_mem=85.66 GB):  19%|â–ˆâ–‰        | 7/36 [00:00<00:02, 12.11it/s]Capturing batches (bs=200 avail_mem=85.65 GB):  19%|â–ˆâ–‰        | 7/36 [00:00<00:02, 12.11it/s]Capturing batches (bs=192 avail_mem=85.65 GB):  19%|â–ˆâ–‰        | 7/36 [00:00<00:02, 12.11it/s]Capturing batches (bs=192 avail_mem=85.65 GB):  25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:00<00:02, 13.32it/s]Capturing batches (bs=184 avail_mem=85.64 GB):  25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:00<00:02, 13.32it/s]Capturing batches (bs=176 avail_mem=85.63 GB):  25%|â–ˆâ–ˆâ–Œ       | 9/36 [00:00<00:02, 13.32it/s]Capturing batches (bs=176 avail_mem=85.63 GB):  31%|â–ˆâ–ˆâ–ˆ       | 11/36 [00:00<00:01, 14.24it/s]Capturing batches (bs=168 avail_mem=85.62 GB):  31%|â–ˆâ–ˆâ–ˆ       | 11/36 [00:00<00:01, 14.24it/s]Capturing batches (bs=160 avail_mem=85.62 GB):  31%|â–ˆâ–ˆâ–ˆ       | 11/36 [00:00<00:01, 14.24it/s]Capturing batches (bs=160 avail_mem=85.62 GB):  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 13/36 [00:01<00:01, 14.57it/s]Capturing batches (bs=152 avail_mem=85.61 GB):  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 13/36 [00:01<00:01, 14.57it/s]Capturing batches (bs=144 avail_mem=85.60 GB):  36%|â–ˆâ–ˆâ–ˆâ–Œ      | 13/36 [00:01<00:01, 14.57it/s]Capturing batches (bs=144 avail_mem=85.60 GB):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 15/36 [00:01<00:01, 14.61it/s]Capturing batches (bs=136 avail_mem=85.59 GB):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 15/36 [00:01<00:01, 14.61it/s]Capturing batches (bs=128 avail_mem=85.59 GB):  42%|â–ˆâ–ˆâ–ˆâ–ˆâ–     | 15/36 [00:01<00:01, 14.61it/s]Capturing batches (bs=128 avail_mem=85.59 GB):  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 17/36 [00:01<00:01, 14.72it/s]Capturing batches (bs=120 avail_mem=85.58 GB):  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 17/36 [00:01<00:01, 14.72it/s]Capturing batches (bs=112 avail_mem=85.57 GB):  47%|â–ˆâ–ˆâ–ˆâ–ˆâ–‹     | 17/36 [00:01<00:01, 14.72it/s]Capturing batches (bs=112 avail_mem=85.57 GB):  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 19/36 [00:01<00:01, 14.89it/s]Capturing batches (bs=104 avail_mem=85.57 GB):  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 19/36 [00:01<00:01, 14.89it/s]Capturing batches (bs=96 avail_mem=85.56 GB):  53%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–    | 19/36 [00:01<00:01, 14.89it/s] Capturing batches (bs=96 avail_mem=85.56 GB):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 21/36 [00:01<00:01, 14.79it/s]Capturing batches (bs=88 avail_mem=85.55 GB):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 21/36 [00:01<00:01, 14.79it/s]Capturing batches (bs=80 avail_mem=85.54 GB):  58%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š    | 21/36 [00:01<00:01, 14.79it/s]Capturing batches (bs=80 avail_mem=85.54 GB):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 23/36 [00:01<00:00, 14.64it/s]Capturing batches (bs=72 avail_mem=85.53 GB):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 23/36 [00:01<00:00, 14.64it/s]Capturing batches (bs=64 avail_mem=85.52 GB):  64%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–   | 23/36 [00:01<00:00, 14.64it/s]Capturing batches (bs=64 avail_mem=85.52 GB):  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 25/36 [00:01<00:00, 14.76it/s]Capturing batches (bs=56 avail_mem=85.51 GB):  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 25/36 [00:01<00:00, 14.76it/s]Capturing batches (bs=48 avail_mem=85.51 GB):  69%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‰   | 25/36 [00:01<00:00, 14.76it/s]Capturing batches (bs=48 avail_mem=85.51 GB):  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:01<00:00, 14.93it/s]Capturing batches (bs=40 avail_mem=85.50 GB):  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:01<00:00, 14.93it/s]Capturing batches (bs=32 avail_mem=85.49 GB):  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 27/36 [00:02<00:00, 14.93it/s]Capturing batches (bs=32 avail_mem=85.49 GB):  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 29/36 [00:02<00:00, 14.97it/s]Capturing batches (bs=24 avail_mem=85.48 GB):  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 29/36 [00:02<00:00, 14.97it/s]Capturing batches (bs=16 avail_mem=85.48 GB):  81%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 29/36 [00:02<00:00, 14.97it/s]Capturing batches (bs=16 avail_mem=85.48 GB):  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 31/36 [00:02<00:00, 13.87it/s]Capturing batches (bs=12 avail_mem=85.47 GB):  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 31/36 [00:02<00:00, 13.87it/s]Capturing batches (bs=8 avail_mem=85.46 GB):  86%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ | 31/36 [00:02<00:00, 13.87it/s] Capturing batches (bs=8 avail_mem=85.46 GB):  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 33/36 [00:02<00:00, 14.56it/s]Capturing batches (bs=4 avail_mem=85.45 GB):  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 33/36 [00:02<00:00, 14.56it/s]Capturing batches (bs=2 avail_mem=85.45 GB):  92%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–| 33/36 [00:02<00:00, 14.56it/s]Capturing batches (bs=2 avail_mem=85.45 GB):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 35/36 [00:02<00:00, 15.60it/s]Capturing batches (bs=1 avail_mem=85.44 GB):  97%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‹| 35/36 [00:02<00:00, 15.60it/s]Capturing batches (bs=1 avail_mem=85.44 GB): 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 36/36 [00:02<00:00, 13.96it/s]
[09:12:39] âœ“ 44.1ç§’
[09:12:39] 
GPU 3æ˜¾å­˜ä½¿ç”¨:
3, 55734, 143771
[09:12:40] 
ğŸ’¡ æ ¸å¿ƒä¼˜åŒ–è¯´æ˜:
[09:12:40]   ã€Stateful KV Cache - æœ€å…³é”®ä¼˜åŒ–ã€‘
[09:12:40]     â€¢ ä¸€æ¬¡æ€§å®šä¹‰æ•´ä¸ªå¤šè½®å¯¹è¯æµç¨‹
[09:12:40]     â€¢ Runtime å†…éƒ¨ç»´æŠ¤ KV stateï¼Œé¿å…æ¯è½® full prefill
[09:12:40]     â€¢ é¦–è½® prefill + åç»­åª decodeï¼Œå¤§å¹…é™ä½è®¡ç®—å¼€é”€ï¼ˆèŠ‚çœ >99% prefillï¼‰
[09:12:40]   ã€æ˜¾å­˜ç®¡ç†ã€‘
[09:12:40]     â€¢ mem_fraction=0.88: å……åˆ†åˆ©ç”¨æ˜¾å­˜ç©ºé—´ï¼ˆvs é»˜è®¤0.8ï¼‰
[09:12:40]     â€¢ max_total_tokens=131k: æ›´å¤§çš„KV cacheå®¹é‡ï¼ˆæ”¯æŒé•¿å¯¹è¯ï¼‰
[09:12:40]   ã€ååé‡è®¡ç®—ã€‘
[09:12:40]     â€¢ æ»‘åŠ¨çª—å£ï¼ˆ10ç§’ï¼‰ï¼šåæ˜ å½“å‰å®æ—¶æ€§èƒ½
[09:12:40]     â€¢ ç´¯è®¡å¹³å‡ï¼šåæ˜ æ•´ä½“å¹³å‡æ€§èƒ½
[09:12:40]   ã€æ³¨æ„ã€‘
[09:12:40]     â€¢ éƒ¨åˆ†é«˜çº§è°ƒåº¦å‚æ•°å·²æ³¨é‡Šï¼ˆSGLang ç‰ˆæœ¬å…¼å®¹æ€§ï¼‰
[09:12:40]     â€¢ Stateful KV Cache æ˜¯æœ€æ ¸å¿ƒä¼˜åŒ–ï¼Œæ•ˆæœæœ€æ˜¾è‘—
[09:12:40] 
[3/3] æµ‹è¯•...
[09:12:40] 
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[09:12:40] Batch Size 16
[09:12:40] 
======================================================================
[09:12:40] æµ‹è¯• Batch Size (å¹¶å‘æ•°): 16
[09:12:40] ======================================================================
[09:12:40] å‡†å¤‡æ•°æ®...
[09:12:40]   å‡†å¤‡: 10/50
[09:12:40]   å‡†å¤‡: 20/50
[09:12:40]   å‡†å¤‡: 30/50
[09:12:40]   å‡†å¤‡: 40/50
[09:12:40]   å‡†å¤‡: 50/50
[09:12:40] âœ“ å‡†å¤‡å®Œæˆ, avg env: 20.22ç§’
[09:12:40] å¼€å§‹å¹¶å‘æ¨ç†ï¼ˆå¹¶å‘æ•°=16ï¼‰...
[09:12:40] ğŸ’¡ Stateful æ¨¡å¼ï¼šæ¯æ¡è½¨è¿¹ä¸€æ¬¡æ€§ç”Ÿæˆæ‰€æœ‰è½®æ¬¡
[09:12:40]    â†’ Runtime å†…éƒ¨ç»´æŠ¤ KV cacheï¼Œé¿å…é‡å¤ prefillï¼ˆæœ€å…³é”®ä¼˜åŒ–ï¼‰
[09:12:40]    â†’ é¦–è½® prefill å®Œæ•´ä¸Šä¸‹æ–‡ï¼Œåç»­è½®æ¬¡åª decode æ–° token
[09:12:40]    â†’ SGLang è‡ªåŠ¨ dynamic batching å¤„ç†å¹¶å‘è¯·æ±‚
[09:39:31]   è¿›åº¦: 5/50 (10%) | è½¨è¿¹: 0.003æ¡/ç§’ | Token(æ»‘çª—): 60.07tok/ç§’ | Token(ç´¯è®¡): 47.38tok/ç§’ | å·²ç”¨æ—¶: 1611.8ç§’
[09:40:07]   è¿›åº¦: 10/50 (20%) | è½¨è¿¹: 0.006æ¡/ç§’ | Token(æ»‘çª—): 27.62tok/ç§’ | Token(ç´¯è®¡): 46.77tok/ç§’ | å·²ç”¨æ—¶: 1647.1ç§’
[09:40:32]   è¿›åº¦: 15/50 (30%) | è½¨è¿¹: 0.009æ¡/ç§’ | Token(æ»‘çª—): 159.17tok/ç§’ | Token(ç´¯è®¡): 47.29tok/ç§’ | å·²ç”¨æ—¶: 1672.8ç§’
[10:07:46]   è¿›åº¦: 20/50 (40%) | è½¨è¿¹: 0.006æ¡/ç§’ | Token(æ»‘çª—): 26689.59tok/ç§’ | Token(ç´¯è®¡): 50.92tok/ç§’ | å·²ç”¨æ—¶: 3306.5ç§’
[10:08:24]   è¿›åº¦: 25/50 (50%) | è½¨è¿¹: 0.007æ¡/ç§’ | Token(æ»‘çª—): 27609.55tok/ç§’ | Token(ç´¯è®¡): 50.73tok/ç§’ | å·²ç”¨æ—¶: 3344.0ç§’
[10:08:50]   è¿›åº¦: 30/50 (60%) | è½¨è¿¹: 0.009æ¡/ç§’ | Token(æ»‘çª—): 477.18tok/ç§’ | Token(ç´¯è®¡): 50.86tok/ç§’ | å·²ç”¨æ—¶: 3370.7ç§’
[10:33:12]   è¿›åº¦: 35/50 (70%) | è½¨è¿¹: 0.007æ¡/ç§’ | Token(æ»‘çª—): 37.53tok/ç§’ | Token(ç´¯è®¡): 52.44tok/ç§’ | å·²ç”¨æ—¶: 4832.0ç§’
[10:34:52]   è¿›åº¦: 40/50 (80%) | è½¨è¿¹: 0.008æ¡/ç§’ | Token(æ»‘çª—): 58503.47tok/ç§’ | Token(ç´¯è®¡): 52.04tok/ç§’ | å·²ç”¨æ—¶: 4932.2ç§’
[10:35:28]   è¿›åº¦: 45/50 (90%) | è½¨è¿¹: 0.009æ¡/ç§’ | Token(æ»‘çª—): 53935.70tok/ç§’ | Token(ç´¯è®¡): 51.88tok/ç§’ | å·²ç”¨æ—¶: 4968.7ç§’
[10:37:56]   è¿›åº¦: 50/50 (100%) | è½¨è¿¹: 0.010æ¡/ç§’ | Token(æ»‘çª—): 73.94tok/ç§’ | Token(ç´¯è®¡): 52.11tok/ç§’ | å·²ç”¨æ—¶: 5116.1ç§’
[10:37:56] 
======================================================================
[10:37:56] Batch Size 16 æµ‹è¯•å®Œæˆ
[10:37:56] ======================================================================
[10:37:56]   âœ“ æˆåŠŸ: 50/50 æ¡è½¨è¿¹
[10:37:56]   âœ— å¤±è´¥: 0 æ¡
[10:37:56]   â±ï¸  æ€»è€—æ—¶: 5116.07 ç§’ (å¹³å‡ 102.32ç§’/æ¡)
[10:37:56]   ğŸ“Š è½¨è¿¹åå: 0.010 æ¡/ç§’
[10:37:56]   ğŸš€ Tokenåå: 52.11 tok/ç§’
[10:37:56]   ğŸ’¬ æ€»tokens: 266,623
[10:37:56]   ğŸ“ å¹³å‡tokens: 5332 tokens/è½¨è¿¹
[10:37:56]   ğŸ“ˆ è®°å½•æ•°: 2,500 æ¡ï¼ˆæ¯è½¨è¿¹50æ¡ï¼‰
[10:37:56] ======================================================================
[10:37:58] 
>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>
[10:37:58] Batch Size 12
[10:37:58] 
======================================================================
[10:37:58] æµ‹è¯• Batch Size (å¹¶å‘æ•°): 12
[10:37:58] ======================================================================
[10:37:58] å‡†å¤‡æ•°æ®...
[10:37:58]   å‡†å¤‡: 10/50
[10:37:58]   å‡†å¤‡: 20/50
[10:37:58]   å‡†å¤‡: 30/50
[10:37:58]   å‡†å¤‡: 40/50
[10:37:58]   å‡†å¤‡: 50/50
[10:37:58] âœ“ å‡†å¤‡å®Œæˆ, avg env: 20.22ç§’
[10:37:58] å¼€å§‹å¹¶å‘æ¨ç†ï¼ˆå¹¶å‘æ•°=12ï¼‰...
[10:37:58] ğŸ’¡ Stateful æ¨¡å¼ï¼šæ¯æ¡è½¨è¿¹ä¸€æ¬¡æ€§ç”Ÿæˆæ‰€æœ‰è½®æ¬¡
[10:37:58]    â†’ Runtime å†…éƒ¨ç»´æŠ¤ KV cacheï¼Œé¿å…é‡å¤ prefillï¼ˆæœ€å…³é”®ä¼˜åŒ–ï¼‰
[10:37:58]    â†’ é¦–è½® prefill å®Œæ•´ä¸Šä¸‹æ–‡ï¼Œåç»­è½®æ¬¡åª decode æ–° token
[10:37:58]    â†’ SGLang è‡ªåŠ¨ dynamic batching å¤„ç†å¹¶å‘è¯·æ±‚
[10:57:55]   è¿›åº¦: 5/50 (10%) | è½¨è¿¹: 0.004æ¡/ç§’ | Token(æ»‘çª—): 56.54tok/ç§’ | Token(ç´¯è®¡): 61.13tok/ç§’ | å·²ç”¨æ—¶: 1197.8ç§’
[10:58:33]   è¿›åº¦: 10/50 (20%) | è½¨è¿¹: 0.008æ¡/ç§’ | Token(æ»‘çª—): 132.28tok/ç§’ | Token(ç´¯è®¡): 60.96tok/ç§’ | å·²ç”¨æ—¶: 1235.8ç§’
[11:16:55]   è¿›åº¦: 15/50 (30%) | è½¨è¿¹: 0.006æ¡/ç§’ | Token(æ»‘çª—): 38191.16tok/ç§’ | Token(ç´¯è®¡): 60.94tok/ç§’ | å·²ç”¨æ—¶: 2337.0ç§’
[11:17:55]   è¿›åº¦: 20/50 (40%) | è½¨è¿¹: 0.008æ¡/ç§’ | Token(æ»‘çª—): 32619.64tok/ç§’ | Token(ç´¯è®¡): 60.50tok/ç§’ | å·²ç”¨æ—¶: 2397.3ç§’
[11:37:45]   è¿›åº¦: 25/50 (50%) | è½¨è¿¹: 0.007æ¡/ç§’ | Token(æ»‘çª—): 28.48tok/ç§’ | Token(ç´¯è®¡): 56.61tok/ç§’ | å·²ç”¨æ—¶: 3587.3ç§’
[11:39:02]   è¿›åº¦: 30/50 (60%) | è½¨è¿¹: 0.008æ¡/ç§’ | Token(æ»‘çª—): 57.00tok/ç§’ | Token(ç´¯è®¡): 56.11tok/ç§’ | å·²ç”¨æ—¶: 3664.2ç§’
[11:39:38]   è¿›åº¦: 35/50 (70%) | è½¨è¿¹: 0.009æ¡/ç§’ | Token(æ»‘çª—): 117.14tok/ç§’ | Token(ç´¯è®¡): 56.32tok/ç§’ | å·²ç”¨æ—¶: 3700.0ç§’
[11:58:03]   è¿›åº¦: 40/50 (80%) | è½¨è¿¹: 0.008æ¡/ç§’ | Token(æ»‘çª—): 99548.09tok/ç§’ | Token(ç´¯è®¡): 55.13tok/ç§’ | å·²ç”¨æ—¶: 4804.9ç§’
[11:59:08]   è¿›åº¦: 45/50 (90%) | è½¨è¿¹: 0.009æ¡/ç§’ | Token(æ»‘çª—): 49.97tok/ç§’ | Token(ç´¯è®¡): 54.80tok/ç§’ | å·²ç”¨æ—¶: 4870.4ç§’
[12:01:47]   è¿›åº¦: 50/50 (100%) | è½¨è¿¹: 0.010æ¡/ç§’ | Token(æ»‘çª—): 30.34tok/ç§’ | Token(ç´¯è®¡): 54.01tok/ç§’ | å·²ç”¨æ—¶: 5028.9ç§’
[12:01:47] 
======================================================================
[12:01:47] Batch Size 12 æµ‹è¯•å®Œæˆ
[12:01:47] ======================================================================
[12:01:47]   âœ“ æˆåŠŸ: 50/50 æ¡è½¨è¿¹
[12:01:47]   âœ— å¤±è´¥: 0 æ¡
[12:01:47]   â±ï¸  æ€»è€—æ—¶: 5028.85 ç§’ (å¹³å‡ 100.58ç§’/æ¡)
[12:01:47]   ğŸ“Š è½¨è¿¹åå: 0.010 æ¡/ç§’
[12:01:47]   ğŸš€ Tokenåå: 54.01 tok/ç§’
[12:01:47]   ğŸ’¬ æ€»tokens: 271,602
[12:01:47]   ğŸ“ å¹³å‡tokens: 5432 tokens/è½¨è¿¹
[12:01:47]   ğŸ“ˆ è®°å½•æ•°: 2,500 æ¡ï¼ˆæ¯è½¨è¿¹50æ¡ï¼‰
[12:01:47] ======================================================================
[12:01:49] 
================================================================================
[12:01:49] ğŸ¯ æµ‹è¯•æ±‡æ€» - Stateful KV Cache æ‰€æœ‰Batch Sizeç»“æœå¯¹æ¯”
[12:01:49] ================================================================================
BS   æ€»è€—æ—¶        å¹³å‡/æ¡       è½¨è¿¹åå           Tokenåå        æ€»Tokens      Tok/è½®     
     (ç§’)        (ç§’)        (æ¡/ç§’)          (tok/ç§’)                               
--------------------------------------------------------------------------------
16   5116.07    102.32     0.010          52.11          266,623      106.6     
12   5028.85    100.58     0.010          54.01          271,602      108.6     
[12:01:49] ================================================================================
[12:01:49] ğŸ’¡ æ³¨æ„ï¼šä½¿ç”¨ Stateful KV Cache åï¼Œååé‡åº”æ˜¾è‘—æå‡
[12:01:49]    å¯¹æ¯”åŸç‰ˆå¯çœ‹å‡ºé¿å…é‡å¤ prefill çš„æ”¶ç›Š
[12:01:49] 
ğŸ† æ€§èƒ½æœ€ä¼˜:
[12:01:49]   â€¢ è½¨è¿¹ååæœ€é«˜: BS=12, 0.010æ¡/ç§’
[12:01:49]   â€¢ Tokenååæœ€é«˜: BS=12, 54.01tok/ç§’
[12:01:49]   â€¢ å•æ¡æœ€å¿«: BS=12, 100.58ç§’/æ¡
[12:01:49] ================================================================================
[12:01:49] 
âœ“ Metadata: per_turn_metrics_stateful_gpu3_50traj_50turns_bs16_12.jsonl
[12:01:49] âœ“ Summary: per_turn_summary_stateful_gpu3_50traj_50turns_bs16_12.json
[12:01:49] æ€»è®°å½•æ•°: 5000
[12:01:49] 
âœ“ å®Œæˆ!
/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
