/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
[2025-11-25 08:21:15] INFO model_config.py:885: Downcasting torch.float32 to torch.float16.
[2025-11-25 08:21:15] WARNING server_args.py:1213: Attention backend not explicitly specified. Use fa3 backend by default.
======================================================================
批量处理性能测试 - 500条轨迹
======================================================================

[1/5] 加载配置文件...
✓ 配置加载完成
  System prompt 长度: 5360 字符

[2/5] 加载轨迹数据...
✓ 加载了 500 条轨迹

[3/5] 正在加载模型...
/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/transformers/utils/hub.py:110: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
Loading safetensors checkpoint shards:   0% Completed | 0/7 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  14% Completed | 1/7 [00:01<00:10,  1.75s/it]
Loading safetensors checkpoint shards:  29% Completed | 2/7 [00:03<00:08,  1.79s/it]
Loading safetensors checkpoint shards:  43% Completed | 3/7 [00:05<00:07,  1.80s/it]
Loading safetensors checkpoint shards:  57% Completed | 4/7 [00:07<00:05,  1.79s/it]
Loading safetensors checkpoint shards:  71% Completed | 5/7 [00:08<00:03,  1.79s/it]
Loading safetensors checkpoint shards:  86% Completed | 6/7 [00:10<00:01,  1.65s/it]
Loading safetensors checkpoint shards: 100% Completed | 7/7 [00:11<00:00,  1.39s/it]
Loading safetensors checkpoint shards: 100% Completed | 7/7 [00:11<00:00,  1.60s/it]

  0%|          | 0/36 [00:00<?, ?it/s]Capturing batches (bs=256 avail_mem=26.91 GB):   0%|          | 0/36 [00:00<?, ?it/s]Capturing batches (bs=256 avail_mem=26.91 GB):   3%|▎         | 1/36 [00:00<00:04,  7.40it/s]Capturing batches (bs=248 avail_mem=26.75 GB):   3%|▎         | 1/36 [00:00<00:04,  7.40it/s]Capturing batches (bs=240 avail_mem=26.74 GB):   3%|▎         | 1/36 [00:00<00:04,  7.40it/s]Capturing batches (bs=232 avail_mem=26.73 GB):   3%|▎         | 1/36 [00:00<00:04,  7.40it/s]Capturing batches (bs=232 avail_mem=26.73 GB):  11%|█         | 4/36 [00:00<00:01, 16.32it/s]Capturing batches (bs=224 avail_mem=26.72 GB):  11%|█         | 4/36 [00:00<00:01, 16.32it/s]Capturing batches (bs=216 avail_mem=26.72 GB):  11%|█         | 4/36 [00:00<00:01, 16.32it/s]Capturing batches (bs=208 avail_mem=26.71 GB):  11%|█         | 4/36 [00:00<00:01, 16.32it/s]Capturing batches (bs=208 avail_mem=26.71 GB):  19%|█▉        | 7/36 [00:00<00:01, 18.69it/s]Capturing batches (bs=200 avail_mem=26.70 GB):  19%|█▉        | 7/36 [00:00<00:01, 18.69it/s]Capturing batches (bs=192 avail_mem=26.69 GB):  19%|█▉        | 7/36 [00:00<00:01, 18.69it/s]Capturing batches (bs=184 avail_mem=26.69 GB):  19%|█▉        | 7/36 [00:00<00:01, 18.69it/s]Capturing batches (bs=184 avail_mem=26.69 GB):  28%|██▊       | 10/36 [00:00<00:01, 19.95it/s]Capturing batches (bs=176 avail_mem=26.68 GB):  28%|██▊       | 10/36 [00:00<00:01, 19.95it/s]Capturing batches (bs=168 avail_mem=26.68 GB):  28%|██▊       | 10/36 [00:00<00:01, 19.95it/s]Capturing batches (bs=160 avail_mem=26.67 GB):  28%|██▊       | 10/36 [00:00<00:01, 19.95it/s]Capturing batches (bs=160 avail_mem=26.67 GB):  36%|███▌      | 13/36 [00:00<00:01, 20.34it/s]Capturing batches (bs=152 avail_mem=26.66 GB):  36%|███▌      | 13/36 [00:00<00:01, 20.34it/s]Capturing batches (bs=144 avail_mem=26.66 GB):  36%|███▌      | 13/36 [00:00<00:01, 20.34it/s]Capturing batches (bs=136 avail_mem=26.65 GB):  36%|███▌      | 13/36 [00:00<00:01, 20.34it/s]Capturing batches (bs=136 avail_mem=26.65 GB):  44%|████▍     | 16/36 [00:00<00:00, 20.43it/s]Capturing batches (bs=128 avail_mem=26.64 GB):  44%|████▍     | 16/36 [00:00<00:00, 20.43it/s]Capturing batches (bs=120 avail_mem=26.63 GB):  44%|████▍     | 16/36 [00:00<00:00, 20.43it/s]Capturing batches (bs=112 avail_mem=26.63 GB):  44%|████▍     | 16/36 [00:00<00:00, 20.43it/s]Capturing batches (bs=112 avail_mem=26.63 GB):  53%|█████▎    | 19/36 [00:00<00:00, 21.00it/s]Capturing batches (bs=104 avail_mem=26.62 GB):  53%|█████▎    | 19/36 [00:00<00:00, 21.00it/s]Capturing batches (bs=96 avail_mem=26.62 GB):  53%|█████▎    | 19/36 [00:01<00:00, 21.00it/s] Capturing batches (bs=88 avail_mem=26.61 GB):  53%|█████▎    | 19/36 [00:01<00:00, 21.00it/s]Capturing batches (bs=88 avail_mem=26.61 GB):  61%|██████    | 22/36 [00:01<00:00, 20.76it/s]Capturing batches (bs=80 avail_mem=26.61 GB):  61%|██████    | 22/36 [00:01<00:00, 20.76it/s]Capturing batches (bs=72 avail_mem=26.60 GB):  61%|██████    | 22/36 [00:01<00:00, 20.76it/s]Capturing batches (bs=64 avail_mem=26.60 GB):  61%|██████    | 22/36 [00:01<00:00, 20.76it/s]Capturing batches (bs=64 avail_mem=26.60 GB):  69%|██████▉   | 25/36 [00:01<00:00, 20.74it/s]Capturing batches (bs=56 avail_mem=26.59 GB):  69%|██████▉   | 25/36 [00:01<00:00, 20.74it/s]Capturing batches (bs=48 avail_mem=26.59 GB):  69%|██████▉   | 25/36 [00:01<00:00, 20.74it/s]Capturing batches (bs=40 avail_mem=26.58 GB):  69%|██████▉   | 25/36 [00:01<00:00, 20.74it/s]Capturing batches (bs=40 avail_mem=26.58 GB):  78%|███████▊  | 28/36 [00:01<00:00, 21.23it/s]Capturing batches (bs=32 avail_mem=26.58 GB):  78%|███████▊  | 28/36 [00:01<00:00, 21.23it/s]Capturing batches (bs=24 avail_mem=26.57 GB):  78%|███████▊  | 28/36 [00:01<00:00, 21.23it/s]Capturing batches (bs=16 avail_mem=26.57 GB):  78%|███████▊  | 28/36 [00:01<00:00, 21.23it/s]Capturing batches (bs=16 avail_mem=26.57 GB):  86%|████████▌ | 31/36 [00:01<00:00, 19.84it/s]Capturing batches (bs=12 avail_mem=26.56 GB):  86%|████████▌ | 31/36 [00:01<00:00, 19.84it/s]Capturing batches (bs=8 avail_mem=26.56 GB):  86%|████████▌ | 31/36 [00:01<00:00, 19.84it/s] Capturing batches (bs=4 avail_mem=26.55 GB):  86%|████████▌ | 31/36 [00:01<00:00, 19.84it/s]Capturing batches (bs=4 avail_mem=26.55 GB):  94%|█████████▍| 34/36 [00:01<00:00, 21.31it/s]Capturing batches (bs=2 avail_mem=26.55 GB):  94%|█████████▍| 34/36 [00:01<00:00, 21.31it/s]Capturing batches (bs=1 avail_mem=26.54 GB):  94%|█████████▍| 34/36 [00:01<00:00, 21.31it/s]Capturing batches (bs=1 avail_mem=26.54 GB): 100%|██████████| 36/36 [00:01<00:00, 20.56it/s]
✓ 模型加载完成！耗时: 48.86秒

[4/5] 开始性能测试...
测试时间: 2025-11-25 08:21:54

======================================================================
测试 Batch Size: 1
======================================================================
准备了 500 条轨迹
平均每条轨迹有 8.0 条消息
平均环境执行时间: 1.0781秒/轨迹
  进度: 10/500 (2.0%), 批次耗时: 0.00秒, 速度: 1098.56 条/秒
  进度: 20/500 (4.0%), 批次耗时: 0.00秒, 速度: 1188.19 条/秒
  进度: 30/500 (6.0%), 批次耗时: 0.00秒, 速度: 1071.89 条/秒
  进度: 40/500 (8.0%), 批次耗时: 0.00秒, 速度: 1090.28 条/秒
  进度: 50/500 (10.0%), 批次耗时: 0.00秒, 速度: 1146.61 条/秒
  进度: 60/500 (12.0%), 批次耗时: 0.00秒, 速度: 1298.95 条/秒
  进度: 70/500 (14.0%), 批次耗时: 0.00秒, 速度: 1180.16 条/秒
  进度: 80/500 (16.0%), 批次耗时: 0.00秒, 速度: 1228.56 条/秒
  进度: 90/500 (18.0%), 批次耗时: 0.00秒, 速度: 1165.73 条/秒
  进度: 100/500 (20.0%), 批次耗时: 0.00秒, 速度: 1384.26 条/秒
  进度: 110/500 (22.0%), 批次耗时: 0.00秒, 速度: 1308.27 条/秒
  进度: 120/500 (24.0%), 批次耗时: 0.00秒, 速度: 1291.35 条/秒
  进度: 130/500 (26.0%), 批次耗时: 0.00秒, 速度: 1442.83 条/秒
  进度: 140/500 (28.0%), 批次耗时: 0.00秒, 速度: 1243.13 条/秒
  进度: 150/500 (30.0%), 批次耗时: 0.00秒, 速度: 1005.35 条/秒
  进度: 160/500 (32.0%), 批次耗时: 0.00秒, 速度: 1244.97 条/秒
  进度: 170/500 (34.0%), 批次耗时: 0.00秒, 速度: 1385.17 条/秒
  进度: 180/500 (36.0%), 批次耗时: 0.00秒, 速度: 1431.01 条/秒
  进度: 190/500 (38.0%), 批次耗时: 0.00秒, 速度: 1435.91 条/秒
  进度: 200/500 (40.0%), 批次耗时: 0.00秒, 速度: 1459.40 条/秒
  进度: 210/500 (42.0%), 批次耗时: 0.00秒, 速度: 1378.35 条/秒
  进度: 220/500 (44.0%), 批次耗时: 0.00秒, 速度: 1284.63 条/秒
  进度: 230/500 (46.0%), 批次耗时: 0.00秒, 速度: 1364.89 条/秒
  进度: 240/500 (48.0%), 批次耗时: 0.00秒, 速度: 1294.14 条/秒
  进度: 250/500 (50.0%), 批次耗时: 0.00秒, 速度: 1200.43 条/秒
  进度: 260/500 (52.0%), 批次耗时: 0.00秒, 速度: 1308.27 条/秒
  进度: 270/500 (54.0%), 批次耗时: 0.00秒, 速度: 1232.53 条/秒
  进度: 280/500 (56.0%), 批次耗时: 0.00秒, 速度: 1347.35 条/秒
  进度: 290/500 (58.0%), 批次耗时: 0.00秒, 速度: 1319.79 条/秒
  进度: 300/500 (60.0%), 批次耗时: 0.00秒, 速度: 1401.37 条/秒
  进度: 310/500 (62.0%), 批次耗时: 0.00秒, 速度: 1340.03 条/秒
  进度: 320/500 (64.0%), 批次耗时: 0.00秒, 速度: 1453.33 条/秒
  进度: 330/500 (66.0%), 批次耗时: 0.00秒, 速度: 1373.83 条/秒
  进度: 340/500 (68.0%), 批次耗时: 0.00秒, 速度: 1380.16 条/秒
  进度: 350/500 (70.0%), 批次耗时: 0.00秒, 速度: 1456.86 条/秒
  进度: 360/500 (72.0%), 批次耗时: 0.00秒, 速度: 1201.81 条/秒
  进度: 370/500 (74.0%), 批次耗时: 0.00秒, 速度: 1446.31 条/秒
  进度: 380/500 (76.0%), 批次耗时: 0.00秒, 速度: 1229.28 条/秒
  进度: 390/500 (78.0%), 批次耗时: 0.00秒, 速度: 1242.02 条/秒
  进度: 400/500 (80.0%), 批次耗时: 0.00秒, 速度: 1243.13 条/秒
  进度: 410/500 (82.0%), 批次耗时: 0.00秒, 速度: 1136.05 条/秒
  进度: 420/500 (84.0%), 批次耗时: 0.00秒, 速度: 1227.12 条/秒
  进度: 430/500 (86.0%), 批次耗时: 0.00秒, 速度: 1174.55 条/秒
  进度: 440/500 (88.0%), 批次耗时: 0.00秒, 速度: 1132.07 条/秒
  进度: 450/500 (90.0%), 批次耗时: 0.00秒, 速度: 1243.49 条/秒
  进度: 460/500 (92.0%), 批次耗时: 0.00秒, 速度: 1356.06 条/秒
  进度: 470/500 (94.0%), 批次耗时: 0.00秒, 速度: 1116.10 条/秒
  进度: 480/500 (96.0%), 批次耗时: 0.00秒, 速度: 1125.99 条/秒
  进度: 490/500 (98.0%), 批次耗时: 0.00秒, 速度: 1205.95 条/秒
  进度: 500/500 (100.0%), 批次耗时: 0.00秒, 速度: 1124.78 条/秒

======================================================================
Batch Size 1 测试结果:
  总轨迹数: 500
  成功处理: 500
  总耗时: 0.66 秒
  平均速度: 759.03 条/秒
  每条轨迹平均耗时: 0.00 秒
  总生成时间: 0.66 秒
  生成token总数: 0
  平均tokens/轨迹: 0.0
  平均生成时间/轨迹: 0.0013 秒
  原始数据平均env时间: 1.0781 秒
======================================================================


======================================================================
测试 Batch Size: 2
======================================================================
准备了 500 条轨迹
平均每条轨迹有 8.0 条消息
平均环境执行时间: 1.0781秒/轨迹
  进度: 20/500 (4.0%), 批次耗时: 0.00秒, 速度: 1083.80 条/秒
  进度: 40/500 (8.0%), 批次耗时: 0.00秒, 速度: 1100.58 条/秒
  进度: 60/500 (12.0%), 批次耗时: 0.00秒, 速度: 1151.17 条/秒
  进度: 80/500 (16.0%), 批次耗时: 0.00秒, 速度: 1152.44 条/秒
  进度: 100/500 (20.0%), 批次耗时: 0.00秒, 速度: 1179.83 条/秒
  进度: 120/500 (24.0%), 批次耗时: 0.00秒, 速度: 1174.22 条/秒
  进度: 140/500 (28.0%), 批次耗时: 0.00秒, 速度: 1126.90 条/秒
  进度: 160/500 (32.0%), 批次耗时: 0.00秒, 速度: 1209.08 条/秒
  进度: 180/500 (36.0%), 批次耗时: 0.00秒, 速度: 1318.76 条/秒
  进度: 200/500 (40.0%), 批次耗时: 0.00秒, 速度: 1052.92 条/秒
  进度: 220/500 (44.0%), 批次耗时: 0.00秒, 速度: 901.81 条/秒
  进度: 240/500 (48.0%), 批次耗时: 0.00秒, 速度: 1322.29 条/秒
  进度: 260/500 (52.0%), 批次耗时: 0.00秒, 速度: 1319.79 条/秒
  进度: 280/500 (56.0%), 批次耗时: 0.00秒, 速度: 1262.96 条/秒
  进度: 300/500 (60.0%), 批次耗时: 0.00秒, 速度: 1267.54 条/秒
  进度: 320/500 (64.0%), 批次耗时: 0.00秒, 速度: 1292.15 条/秒
  进度: 340/500 (68.0%), 批次耗时: 0.00秒, 速度: 1163.47 条/秒
  进度: 360/500 (72.0%), 批次耗时: 0.00秒, 速度: 1108.43 条/秒
  进度: 380/500 (76.0%), 批次耗时: 0.00秒, 速度: 1121.02 条/秒
  进度: 400/500 (80.0%), 批次耗时: 0.00秒, 速度: 1082.40 条/秒
  进度: 420/500 (84.0%), 批次耗时: 0.00秒, 速度: 1094.69 条/秒
  进度: 440/500 (88.0%), 批次耗时: 0.00秒, 速度: 1086.75 条/秒
  进度: 460/500 (92.0%), 批次耗时: 0.00秒, 速度: 1265.82 条/秒
  进度: 480/500 (96.0%), 批次耗时: 0.00秒, 速度: 1218.39 条/秒
  进度: 500/500 (100.0%), 批次耗时: 0.00秒, 速度: 1224.26 条/秒

======================================================================
Batch Size 2 测试结果:
  总轨迹数: 500
  成功处理: 500
  总耗时: 0.43 秒
  平均速度: 1155.34 条/秒
  每条轨迹平均耗时: 0.00 秒
  总生成时间: 0.43 秒
  生成token总数: 0
  平均tokens/轨迹: 0.0
  平均生成时间/轨迹: 0.0009 秒
  原始数据平均env时间: 1.0781 秒
======================================================================


======================================================================
测试 Batch Size: 4
======================================================================
准备了 500 条轨迹
平均每条轨迹有 8.0 条消息
平均环境执行时间: 1.0781秒/轨迹
  进度: 40/500 (8.0%), 批次耗时: 0.00秒, 速度: 1134.36 条/秒
  进度: 80/500 (16.0%), 批次耗时: 0.00秒, 速度: 1139.14 条/秒
  进度: 120/500 (24.0%), 批次耗时: 0.00秒, 速度: 1198.63 条/秒
  进度: 160/500 (32.0%), 批次耗时: 0.00秒, 速度: 1211.26 条/秒
  进度: 200/500 (40.0%), 批次耗时: 0.00秒, 速度: 1234.25 条/秒
  进度: 240/500 (48.0%), 批次耗时: 0.00秒, 速度: 1196.66 条/秒
  进度: 280/500 (56.0%), 批次耗时: 0.00秒, 速度: 1183.83 条/秒
  进度: 320/500 (64.0%), 批次耗时: 0.00秒, 速度: 1185.17 条/秒
  进度: 360/500 (72.0%), 批次耗时: 0.00秒, 速度: 1130.39 条/秒
  进度: 400/500 (80.0%), 批次耗时: 0.00秒, 速度: 1160.25 条/秒
  进度: 440/500 (88.0%), 批次耗时: 0.00秒, 速度: 1177.76 条/秒
  进度: 480/500 (96.0%), 批次耗时: 0.00秒, 速度: 1189.62 条/秒
  进度: 500/500 (100.0%), 批次耗时: 0.00秒, 速度: 1146.45 条/秒

======================================================================
Batch Size 4 测试结果:
  总轨迹数: 500
  成功处理: 500
  总耗时: 0.42 秒
  平均速度: 1180.18 条/秒
  每条轨迹平均耗时: 0.00 秒
  总生成时间: 0.42 秒
  生成token总数: 0
  平均tokens/轨迹: 0.0
  平均生成时间/轨迹: 0.0008 秒
  原始数据平均env时间: 1.0781 秒
======================================================================


======================================================================
测试 Batch Size: 8
======================================================================
准备了 500 条轨迹
平均每条轨迹有 8.0 条消息
平均环境执行时间: 1.0781秒/轨迹
  进度: 80/500 (16.0%), 批次耗时: 0.01秒, 速度: 1124.14 条/秒
  进度: 160/500 (32.0%), 批次耗时: 0.01秒, 速度: 1148.02 条/秒
  进度: 240/500 (48.0%), 批次耗时: 0.01秒, 速度: 1136.09 条/秒
  进度: 320/500 (64.0%), 批次耗时: 0.01秒, 速度: 1132.26 条/秒
  进度: 400/500 (80.0%), 批次耗时: 0.01秒, 速度: 1121.47 条/秒
  进度: 480/500 (96.0%), 批次耗时: 0.01秒, 速度: 1129.09 条/秒
  进度: 500/500 (100.0%), 批次耗时: 0.00秒, 速度: 1193.94 条/秒

======================================================================
Batch Size 8 测试结果:
  总轨迹数: 500
  成功处理: 500
  总耗时: 0.44 秒
  平均速度: 1125.02 条/秒
  每条轨迹平均耗时: 0.00 秒
  总生成时间: 0.44 秒
  生成token总数: 0
  平均tokens/轨迹: 0.0
  平均生成时间/轨迹: 0.0009 秒
  原始数据平均env时间: 1.0781 秒
======================================================================


======================================================================
测试 Batch Size: 16
======================================================================
准备了 500 条轨迹
平均每条轨迹有 8.0 条消息
平均环境执行时间: 1.0781秒/轨迹
  进度: 160/500 (32.0%), 批次耗时: 0.01秒, 速度: 1094.96 条/秒
  进度: 320/500 (64.0%), 批次耗时: 0.01秒, 速度: 1077.60 条/秒
  进度: 480/500 (96.0%), 批次耗时: 0.02秒, 速度: 1062.91 条/秒
  进度: 500/500 (100.0%), 批次耗时: 0.00秒, 速度: 1060.24 条/秒

======================================================================
Batch Size 16 测试结果:
  总轨迹数: 500
  成功处理: 500
  总耗时: 0.73 秒
  平均速度: 683.74 条/秒
  每条轨迹平均耗时: 0.00 秒
  总生成时间: 0.73 秒
  生成token总数: 0
  平均tokens/轨迹: 0.0
  平均生成时间/轨迹: 0.0015 秒
  原始数据平均env时间: 1.0781 秒
======================================================================


[5/5] 性能测试汇总
======================================================================
Batch    总耗时          吞吐量            每条耗时           生成耗时          
Size     (秒)          (条/秒)          (秒)            (秒)           
----------------------------------------------------------------------
1        0.66         759.03         0.0013         0.0013        
2        0.43         1155.34        0.0009         0.0009        
4        0.42         1180.18        0.0008         0.0008        
8        0.44         1125.02        0.0009         0.0009        
16       0.73         683.74         0.0015         0.0015        
======================================================================

最优配置: Batch Size = 4, 吞吐量 = 1180.18 条/秒

结果已保存到: benchmark_results_500.json

清理资源...
✓ 所有测试完成！
/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/sglang/lang/interpreter.py:410: UserWarning: Error in stream_executor: Traceback (most recent call last):
  File "/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/sglang/lang/interpreter.py", line 408, in _thread_worker_func
    self._execute(expr)
  File "/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/sglang/lang/interpreter.py", line 451, in _execute
    self._execute(x)
  File "/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/sglang/lang/interpreter.py", line 446, in _execute
    self._execute_gen(other)
  File "/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/sglang/lang/interpreter.py", line 574, in _execute_gen
    comp, meta_info = self.backend.generate(
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/sglang/lang/backend/runtime_endpoint.py", line 185, in generate
    res = http_request(
          ^^^^^^^^^^^^^
  File "/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/sglang/utils.py", line 170, in http_request
    resp = urllib.request.urlopen(req, data=data, cafile=verify)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/urllib/request.py", line 519, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/urllib/request.py", line 536, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/urllib/request.py", line 496, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/urllib/request.py", line 1377, in http_open
    return self.do_open(http.client.HTTPConnection, req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/urllib/request.py", line 1352, in do_open
    r = h.getresponse()
        ^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/http/client.py", line 1395, in getresponse
    response.begin()
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/http/client.py", line 325, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/http/client.py", line 294, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

  warnings.warn(f"Error in stream_executor: {get_exception_traceback()}")
/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/sglang/lang/interpreter.py:410: UserWarning: Error in stream_executor: Traceback (most recent call last):
  File "/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/sglang/lang/interpreter.py", line 408, in _thread_worker_func
    self._execute(expr)
  File "/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/sglang/lang/interpreter.py", line 451, in _execute
    self._execute(x)
  File "/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/sglang/lang/interpreter.py", line 446, in _execute
    self._execute_gen(other)
  File "/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/sglang/lang/interpreter.py", line 574, in _execute_gen
    comp, meta_info = self.backend.generate(
                      ^^^^^^^^^^^^^^^^^^^^^^
  File "/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/sglang/lang/backend/runtime_endpoint.py", line 185, in generate
    res = http_request(
          ^^^^^^^^^^^^^
  File "/minimax-dialogue/users/ruobai/cogito_dev/course_project_854/.venv/lib/python3.11/site-packages/sglang/utils.py", line 170, in http_request
    resp = urllib.request.urlopen(req, data=data, cafile=verify)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/urllib/request.py", line 216, in urlopen
    return opener.open(url, data, timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/urllib/request.py", line 519, in open
    response = self._open(req, data)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/urllib/request.py", line 536, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/urllib/request.py", line 496, in _call_chain
    result = func(*args)
             ^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/urllib/request.py", line 1377, in http_open
    return self.do_open(http.client.HTTPConnection, req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/urllib/request.py", line 1352, in do_open
    r = h.getresponse()
        ^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/http/client.py", line 1395, in getresponse
    response.begin()
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/http/client.py", line 325, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/http/client.py", line 286, in _read_status
    line = str(self.fp.readline(_MAXLINE + 1), "iso-8859-1")
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/socket.py", line 718, in readinto
    return self._sock.recv_into(b)
           ^^^^^^^^^^^^^^^^^^^^^^^
ConnectionResetError: [Errno 104] Connection reset by peer

  warnings.warn(f"Error in stream_executor: {get_exception_traceback()}")
/home/ruobai/.local/share/uv/python/cpython-3.11.13-linux-x86_64-gnu/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 1 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
